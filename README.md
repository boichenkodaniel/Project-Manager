# Project Manager - Система управления проектами

Система управления проектами с авторизацией пользователей, ролевой моделью доступа и системой уведомлений.

## Возможности

- **Авторизация пользователей** - вход по логину и паролю
- **Ролевая модель доступа**:
  - **Администратор** - полный доступ, управление пользователями
  - **Руководитель проектов** - создание проектов и задач, назначение работников, проверка выполнения
  - **Исполнитель** - выполнение задач, отправка issues
  - **Клиент** - просмотр выполнения задач и проектов
- **Управление проектами** - создание, редактирование, удаление проектов
- **Управление задачами** - создание задач, назначение исполнителей, отслеживание статусов
- **Система Issues** - создание и отслеживание проблем/замечаний
- **Уведомления** - автоматические уведомления участникам проектов и задач

## Установка

### Требования

- PHP 7.4+
- PostgreSQL 12+
- Node.js 16+ (для фронтенда)
- Vite (для сборки фронтенда)

### Шаги установки

1. **Клонируйте репозиторий**
   ```bash
   git clone <repository-url>
   cd Project-Manager
   ```

2. **Настройте базу данных**
   - Создайте базу данных PostgreSQL с именем `Project-manager`
   - Выполните SQL скрипт для обновления структуры:
   ```bash
   psql -U postgres -d Project-manager -f database_update.sql
   ```

3. **Настройте подключение к БД**
   Отредактируйте файл `src/backend/config/db.php`:
   ```php
   $host = 'localhost';
   $dbname = 'Project-manager';
   $username = 'postgres';
   $password = 'your_password';
   ```

4. **Установите зависимости фронтенда**
   ```bash
   npm install
   ```

5. **Запустите серверы**
   
   В одном терминале запустите PHP сервер:
   ```bash
   npm run backend
   ```
   
   В другом терминале запустите Vite:
   ```bash
   npm run dev
   ```
   
   Или используйте команду для одновременного запуска:
   ```bash
   npm run dev:full
   ```

6. **Откройте приложение**
   - Перейдите на `http://localhost:5173/login.html` (или другой порт, указанный Vite)
   - Войдите с учетными данными администратора

## Создание первого пользователя

Для создания первого администратора выполните SQL запрос:

```sql
INSERT INTO "User" (fullname, email, login, password, role)
VALUES ('Администратор', 'admin@example.com', 'admin', '$2y$10$...', 'Администратор');
```

Или используйте интерфейс после входа администратора.

## Структура проекта

```
Project-Manager/
├── src/
│   ├── backend/
│   │   ├── config/          # Конфигурация БД
│   │   ├── controllers/      # Контроллеры API
│   │   ├── models/           # Модели данных
│   │   ├── middleware/       # Middleware для авторизации
│   │   └── index.php         # Точка входа API
│   ├── modules/              # JavaScript модули
│   ├── assets/               # Статические ресурсы
│   └── style.css             # Стили
├── database_update.sql       # SQL скрипт обновления БД
├── login.html                # Страница входа
├── index.html                # Главная страница
└── package.json              # Зависимости Node.js
```

## API Endpoints

### Авторизация
- `POST /api?action=auth.login` - Вход в систему
- `POST /api?action=auth.logout` - Выход
- `GET /api?action=auth.me` - Получить текущего пользователя

### Пользователи (только для администратора)
- `GET /api?action=user.index` - Список пользователей
- `GET /api?action=user.get&id={id}` - Получить пользователя
- `POST /api?action=user.create` - Создать пользователя
- `POST /api?action=user.update&id={id}` - Обновить пользователя
- `GET /api?action=user.delete&id={id}` - Удалить пользователя

### Проекты
- `GET /api?action=projects.index` - Список проектов
- `GET /api?action=projects.get&id={id}` - Получить проект
- `POST /api?action=projects.create` - Создать проект (руководитель/админ)
- `POST /api?action=projects.update&id={id}` - Обновить проект
- `GET /api?action=projects.delete&id={id}` - Удалить проект

### Задачи
- `GET /api?action=task.index` - Список задач
- `GET /api?action=task.get&id={id}` - Получить задачу
- `POST /api?action=task.create` - Создать задачу (руководитель/админ)
- `POST /api?action=task.update&id={id}` - Обновить задачу
- `GET /api?action=task.delete&id={id}` - Удалить задачу
- `GET /api?action=task.byProject&id={projectId}` - Задачи по проекту
- `GET /api?action=task.byExecutor&id={userId}` - Задачи по исполнителю

### Issues
- `GET /api?action=issue.index` - Список issues
- `GET /api?action=issue.get&id={id}` - Получить issue
- `POST /api?action=issue.create` - Создать issue
- `POST /api?action=issue.update&id={id}` - Обновить issue
- `GET /api?action=issue.delete&id={id}` - Удалить issue
- `GET /api?action=issue.byProject&id={projectId}` - Issues по проекту

### Уведомления
- `GET /api?action=notification.index` - Список уведомлений
- `POST /api?action=notification.markAsRead&id={id}` - Отметить как прочитанное
- `POST /api?action=notification.markAllAsRead` - Отметить все как прочитанные
- `GET /api?action=notification.delete&id={id}` - Удалить уведомление

## Роли и права доступа

### Администратор
- Полный доступ ко всем функциям
- Управление пользователями (создание, редактирование, удаление)
- Создание и управление проектами и задачами
- Просмотр всех данных

### Руководитель проектов
- Создание и управление проектами
- Создание и управление задачами
- Назначение исполнителей на задачи
- Проверка выполнения задач
- Просмотр всех проектов и задач

### Исполнитель
- Просмотр назначенных задач
- Выполнение задач (изменение статуса)
- Создание issues
- Просмотр проектов, в которых участвует

### Клиент
- Просмотр своих проектов
- Просмотр задач в своих проектах
- Просмотр issues в своих проектах

## Уведомления

Система автоматически отправляет уведомления в следующих случаях:
- Создание нового проекта (клиенту проекта)
- Создание новой задачи (участникам проекта)
- Назначение задачи исполнителю
- Изменение статуса задачи
- Создание issue в проекте

## Разработка

### Структура бэкенда
- **Models** - работа с базой данных
- **Controllers** - обработка HTTP запросов
- **Middleware** - проверка авторизации и прав доступа

### Структура фронтенда
- **modules/** - JavaScript модули для работы с данными
- **assets/** - иконки, шрифты и другие ресурсы
- HTML файлы - страницы приложения

## Лицензия

MIT

